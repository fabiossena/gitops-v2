apiVersion: v1
kind: ConfigMap
metadata:
  name: clickvisual-config
data:
  default.toml: |
    [app]
    secretKey = "secretKey" # hashStatecode
    rootURL = "http://clickvisual.production-observability.svc.cluster.local:19001"  # Ajustado para o serviço interno
    baseURL = "/api/admin/login/"
    permissionFile = './config/resource.yaml'

    [casbin.rule]
    path = "./config/rbac.conf"

    [server.http]
    host = "0.0.0.0"
    port = 19001
    embedPath = "dist"
    maxAge = 86400

    [server.governor]
    host = "0.0.0.0"
    port = 19011

    [logger]
    level = "debug"
    name = "clickvisual.log"

    [mysql]
    connMaxLifetime = "300s"
    debug = true
    dsn = "root:root123@tcp(mysql.production-database.svc.cluster.local:3306)/clickvisual?charset=utf8mb4&collation=utf8mb4_general_ci&parseTime=True&loc=Local&readTimeout=1s&timeout=1s&writeTimeout=3s&tls=false&allowNativePasswords=true"
    level = "panic"
    maxIdleConns = 50
    maxOpenConns = 100

    [auth]
    mode = "memstore" # redis memstore
    name = "clickvisual_session"
    debug = true
    Keypairs = "secret"

    [auth.anonymous]
    # enable anonymous access
    enabled = false

    [auth.proxy]
    enabled = false
    isAutoLogin = false
    headerName = "X-CLICKVISUAL-USER"
    headerNickName = "X-CLICKVISUAL-NICKNAME"
    rootTokenKey = "X-CLICKVISUAL-TOKEN"
    rootTokenValue = "xxx"

    # Removendo os [[auth.tps]] para simplificar. Se necessário, adicione depois.

    [prom2click]
    enable = false  # Desabilitado inicialmente para simplificar

    [defaultCh]
    dsn="clickhouse://root:@clickhouse:9000/default?max_execution_time=60"  # Ajuste a senha se necessário

    [clickhouse]
    host = "clickhouse"
    port = 9000  # Usando a porta TCP nativa, mas pode ser 8123 para HTTP. Ajuste conforme necessário.
    database = "default"